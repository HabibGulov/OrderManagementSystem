# Система Управления Заказами

## Описание

Это API для системы управления заказами, разработанное с использованием .NET 8, Dapper и PostgreSQL. API предоставляет функциональность для управления клиентами, продуктами и заказами.

## Технологии

- **.NET 8** (ASP.NET Core Web API)
- **Dapper** (для работы с базой данных)
- **PostgreSQL** (для хранения данных)
- **Асинхронное программирование** (асинхронные методы для работы с данными)
- **Dependency Injection (DI)** для управления зависимостями
- **Class Library** для разделения проекта на модули

## Структура базы данных

### Таблица Customers (Клиенты)

- `Id` (UUID, Primary Key)
- `FullName` (строка, уникальная)
- `Email` (строка, уникальная)
- `Phone` (строка)
- `CreatedAt` (дата создания)

### Таблица Products (Продукты)

- `Id` (UUID, Primary Key)
- `Name` (строка, уникальная)
- `Price` (число)
- `StockQuantity` (число, количество на складе)
- `CreatedAt` (дата создания)

### Таблица Orders (Заказы)

- `Id` (UUID, Primary Key)
- `CustomerId` (UUID, Foreign Key, ссылается на Customers)
- `TotalAmount` (число)
- `OrderDate` (дата заказа)
- `Status` (строка, например "Pending", "Completed")
- `CreatedAt` (дата создания)

### Таблица OrderItems (Элементы заказа)

- `Id` (UUID, Primary Key)
- `OrderId` (UUID, Foreign Key, ссылается на Orders)
- `ProductId` (UUID, Foreign Key, ссылается на Products)
- `Quantity` (число)
- `Price` (число)
- `CreatedAt` (дата создания)

## Функциональность API

### CRUD-операции для всех таблиц:

- Создание, чтение, обновление и удаление клиентов, продуктов и заказов.

### API для GET-запросов:

- **Получение клиентов с заказами за определенный период**  
  `GET /api/customers/orders?startDate={startDate}&endDate={endDate}`  
  Возвращает список клиентов с их заказами, созданными в указанный период.

- **Получение продуктов с нулевым количеством на складе**  
  `GET /api/products/out-of-stock`  
  Возвращает список всех продуктов, у которых количество на складе равно нулю.

- **Получение общего количества заказов и общей суммы по каждому клиенту**  
  `GET /api/customers/statistics`  
  Возвращает статистику по каждому клиенту, включая общее количество заказов и общую сумму, потраченную каждым клиентом.

- **Получение всех заказов с информацией о клиентах и товарах**  
  `GET /api/orders/details`  
  Возвращает список всех заказов с информацией о клиентах и товарах для каждого заказа.

- **Получение заказов с фильтрацией по статусу и дате заказа**  
  `GET /api/orders?status={status}&startDate={startDate}&endDate={endDate}`  
  Возвращает список заказов, отфильтрованных по статусу и дате заказа.

- **Получение самого популярного продукта по количеству продаж**  
  `GET /api/products/popular`  
  Возвращает продукт с наибольшим количеством продаж.

- **Получение статистики по продажам за месяц**  
  `GET /api/orders/sales-statistics?month={month}&year={year}`  
  Возвращает статистику по продажам за указанный месяц и год.

- **Получение всех заказов для конкретного продукта**  
  `GET /api/products/{productId}/orders`  
  Возвращает все заказы, содержащие указанный продукт.

- **Получение информации о заказах с общей суммой по каждому продукту**  
  `GET /api/orders/products-summary`  
  Возвращает список продуктов с их общей суммой по всем заказам.